<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Lecture</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: linear-gradient(to bottom, #cfefff, #eaf9ff);
  font-family: Georgia, serif;
  overflow: hidden;
}

/* Navigation */
.nav {
  position: fixed;
  top: 20px;
  font-size: 14px;
  letter-spacing: 1px;
  color: rgba(0,0,0,0.6);
  text-decoration: none;
}

#back { left: 30px; }
#prev { right: 120px; }
#next { right: 30px; }

.nav:hover {
  opacity: 0.5;
}

/* Zone PDF */
#pdf-container {
  position: absolute;
  top: 60px;
  bottom: 20px;
  left: 0;
  right: 0;
  overflow: auto;
  display: flex;
  justify-content: center;
}

canvas {
  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
}
</style>
</head>
<body>

<a id="back" class="nav" href="index.html">‚Üê retour</a>
<a id="prev" class="nav" href="#">‚Üê pr√©c√©dent</a>
<a id="next" class="nav" href="#">suivant ‚Üí</a>

<div id="pdf-container">
  <canvas id="pdf-render"></canvas>
</div>

<script src="pdfjs/build/pdf.js"></script>
<script>

const urlParams = new URLSearchParams(window.location.search);
const pdfFile = urlParams.get('pdf');

const pdfjsLib = window['pdfjs-dist/build/pdf'];
pdfjsLib.GlobalWorkerOptions.workerSrc = 'pdfjs/build/pdf.worker.js';

let pdfDoc = null;
let pageNum = 1;
const canvas = document.getElementById('pdf-render');
const ctx = canvas.getContext('2d');

function renderPage(num) {
  pdfDoc.getPage(num).then(function(page) {
    const viewport = page.getViewport({ scale: 1.5 });
    canvas.height = viewport.height;
    canvas.width = viewport.width;

    const renderContext = {
      canvasContext: ctx,
      viewport: viewport
    };
    page.render(renderContext);
  });
}

if (pdfFile) {
  pdfjsLib.getDocument(pdfFile).promise.then(function(pdfDoc_) {
    pdfDoc = pdfDoc_;
    renderPage(pageNum);
  });
}

/* Navigation pages */
document.addEventListener('keydown', function(e) {
  if (e.key === "ArrowRight" && pageNum < pdfDoc.numPages) {
    pageNum++;
    renderPage(pageNum);
  }
  if (e.key === "ArrowLeft" && pageNum > 1) {
    pageNum--;
    renderPage(pageNum);
  }
});

/* Navigation chapitres */
const chapters = [
  "01_ma_chance.pdf",
  "02_vers_de_nouvelles_mers.pdf",
  "03_sanctus_ianus.pdf",
  "04_le_signe_du_feu.pdf",
  "05_monde.pdf"
  // üëâ continue la liste ici
];

const currentIndex = chapters.indexOf(pdfFile);

if (currentIndex > 0) {
  document.getElementById("prev").href =
    "lecteur.html?pdf=" + chapters[currentIndex - 1];
} else {
  document.getElementById("prev").style.display = "none";
}

if (currentIndex < chapters.length - 1) {
  document.getElementById("next").href =
    "lecteur.html?pdf=" + chapters[currentIndex + 1];
} else {
  document.getElementById("next").style.display = "none";
}

</script>

</body>
</html>
